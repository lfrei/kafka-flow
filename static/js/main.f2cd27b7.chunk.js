(this["webpackJsonpkafka-flow"]=this["webpackJsonpkafka-flow"]||[]).push([[0],{145:function(t){t.exports=JSON.parse('{"simple":"Topologies:\\r\\n   Sub-topology: 0\\r\\n    Source: KSTREAM-SOURCE-0000000000 (topics: [input])\\r\\n      --\x3e KSTREAM-FILTER-0000000001\\r\\n    Processor: KSTREAM-FILTER-0000000001 (stores: [])\\r\\n      --\x3e KSTREAM-MAPVALUES-0000000002\\r\\n      <-- KSTREAM-SOURCE-0000000000\\r\\n    Processor: KSTREAM-MAPVALUES-0000000002 (stores: [])\\r\\n      --\x3e KSTREAM-SINK-0000000003\\r\\n      <-- KSTREAM-FILTER-0000000001\\r\\n    Sink: KSTREAM-SINK-0000000003 (topic: output)\\r\\n      <-- KSTREAM-MAPVALUES-0000000002"}')},150:function(t,e,o){},151:function(t,e,o){},152:function(t,e,o){},154:function(t,e,o){},334:function(t,e,o){},335:function(t,e,o){},339:function(t,e,o){"use strict";o.r(e);var n=o(0),r=o.n(n),c=o(34),a=o.n(c),i=(o(150),o(20)),s=o(16),l=o(62),u=(o(151),o(88)),f=(o(152),o(9)),p=(o(154),o(60)),d=o(1);var h=function(t){var e=t.type,o=t.name,n=t.offset,r=o.length>26,c=n>=0;return Object(d.jsxs)("div",{children:[r&&Object(d.jsx)(p.a,{id:o,place:"bottom",effect:"solid",type:"light",border:!0,borderColor:"lightgrey",offset:{bottom:10},children:Object(d.jsx)("p",{children:o})}),Object(d.jsxs)("div",{className:e,"data-tip":!0,"data-for":o,children:[o,c&&Object(d.jsxs)("span",{children:[":",Object(d.jsx)("div",{className:"offset",children:n})]})]})]})};function b(t,e){return"".concat(t,"-").concat(e)}function j(t,e){var o=t.findIndex((function(t){return t.id===e.id}));-1!==o?t[o]=function(t){return Object(s.a)(Object(s.a)({},t),{},{type:"default"})}(e):t.push(e)}var g=function(t,e){var o,n=[];return t.split("\n").forEach((function(t){var r=/(Source:|Processor:|Sink:)\s+(\S+)\s+\((topics|topic|stores):(.*)\)/.exec(t);if(r){o=r[2];var c=r[3];return r[4].split(",").map((function(t){return t.replace(/[[\]]/g,"").trim()})).forEach((function(t){""===t||("topic"===c?function(t,e,o){j(t,{id:o,type:"output",data:{label:Object(d.jsx)(h,{type:"topic",name:o})}}),t.push({id:b(e,o),source:e,target:o})}(n,o,t):"topics"===c?function(t,e,o){j(t,{id:o,type:"input",data:{label:Object(d.jsx)(h,{type:"topic",name:o})}}),t.push({id:b(o,e),source:o,target:e})}(n,o,t):"stores"===c&&e&&function(t,e,o){(function(t,e){return t.some((function(t){return t.id===e}))})(t,o)||t.push({id:o,type:"output",data:{label:Object(d.jsx)(h,{type:"store",name:o})}}),e.includes("JOIN")?t.push({id:b(o,e),source:o,target:e}):t.push({id:b(e,o),source:e,target:o})}(n,o,t))})),void function(t,e){t.push({id:e,data:{label:Object(d.jsx)(h,{type:"processor",name:e})}})}(n,o)}var a=/-->\s+(.*)$/.exec(t.trim());a&&o&&a[1].split(",").map((function(t){return t.trim()})).forEach((function(t){!function(t,e,o){"none"!==o&&t.push({id:b(e,o),source:e,target:o})}(n,o,t)}))})),n},m=o(41);function O(t,e){var o=[],n=function(t,e){return t.filter((function(t){return!Object(f.b)(t)})).filter((function(t){return t.source===e}))}(t,e);return n.forEach((function(e){!function(t,e){return t.filter((function(t){return Object(f.b)(t)})).filter((function(t){return t.id===e})).filter((function(t){return"output"===t.type})).length>0}(t,e.target)?o.push.apply(o,Object(m.a)(O(t,e.target))):o.push(e.target)})),o}var x=function(t){var e=[];return function(t){return t.filter((function(t){return"input"===t.type})).map((function(t){return t.id}))}(t).forEach((function(o){O(t,o).forEach((function(t){e.push({id:"".concat(o,"-").concat(t),source:o,target:t})}))})),t.filter((function(t){return Object(f.b)(t)})).filter((function(t){return"input"===t.type||"output"===t.type})).concat(e)},y=o(86),v=o.n(y);var k=function(t){var e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"TB",e=new v.a.graphlib.Graph;return e.setDefaultEdgeLabel((function(){return{}})),e.setGraph({rankdir:t}),e}("LR");return t.forEach((function(t){Object(f.b)(t)?e.setNode(t.id,{width:180,height:50}):e.setEdge(t.source,t.target)})),v.a.layout(e),t.map((function(t){if(Object(f.b)(t)){var o=e.node(t.id);t.targetPosition="left",t.sourcePosition="right",t.position={x:50+o.x-90+Math.random()/1e3,y:50+o.y-25}}return t}))};var S=function(t){return t.filter((function(t){return"input"===t.type||"output"===t.type})).map((function(t){return t.id}))},E=o(21),C=o.n(E),N=o(61);function T(){return(T=Object(N.a)(C.a.mark((function t(e,o){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch("".concat(e,"/").concat(o)));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var w=function(t,e){return T.apply(this,arguments)};function R(t,e,o){if(t.id===e){var n=function(t,e){return e>t.data.offset}(t,o);t.data=function(t,e,o,n){return Object(s.a)(Object(s.a)({},t.data),{},{offset:o,running:n,label:Object(d.jsx)(h,{type:"topic",name:e,offset:o})})}(t,e,o,n),t.style=function(t,e){return Object(s.a)(Object(s.a)({},t.style),{},{background:e?"#D6D5E6":"#fff"})}(t,n)}return t}var U=function(t,e,o){return t.map((function(t){return R(t,e,o)}))};function I(t,e){var o=[];return t.forEach((function(n){Object(f.b)(n)||n.target!==e||(o.push(n.id),o.push.apply(o,Object(m.a)(I(t,n.source))))})),o}var A=function(t,e){var o=[];return t.forEach((function(n){Object(f.b)(n)&&n.id===e&&n.data.running&&o.push.apply(o,Object(m.a)(I(t,n.id)))})),t.forEach((function(t){!Object(f.b)(t)&&o.includes(t.id)?t.animated=!0:t.animated=!1})),t};var L=function(t){var e=t.settings,o=t.onError,r=k(g(e.topology)),c=Object(n.useState)(r),a=Object(l.a)(c,2),i=a[0],s=a[1];return Object(n.useEffect)((function(){var t=g(e.topology,e.topologyShowStores);e.topologyCompact&&(t=x(t)),s(k(t))}),[e,s]),Object(n.useEffect)((function(){if(e.offsetCheck){var t=setInterval((function(){S(i).forEach((function(n){w(e.offsetUrl,n).then((function(t){return t.json()})).then((function(t){s((function(e){return A(U(e,n,t),n)}))})).catch((function(){clearInterval(t),o("Failed to load offset for topic ".concat(n))}))}))}),e.offsetInterval);return function(){return clearInterval(t)}}}),[i,s,e,o]),Object(d.jsx)("div",{style:{height:600},className:"flow-area",children:Object(d.jsx)(f.a,{elements:i})})},M=(o(334),o(335),o(63));var K=function(t){var e=t.onSetttingsClicked,o=t.onCompactClicked,n=t.isCompact;return Object(d.jsxs)("div",{className:"float-end toolbar",children:[Object(d.jsx)(p.a,{id:"tooltip-compact",place:"left",effect:"solid",type:"light",border:!0,borderColor:"lightgrey",children:n?"Expand topology":"Compact topology"}),Object(d.jsx)("span",{className:"toolbar-icon","data-tip":!0,"data-for":"tooltip-compact",children:n?Object(d.jsx)(M.a,{onClick:o,"data-testid":"expand-topology"}):Object(d.jsx)(M.b,{onClick:o,"data-testid":"compact-topology"})}),Object(d.jsx)("span",{className:"toolbar-icon",children:Object(d.jsx)(M.c,{onClick:e})})]})},F=o(4);var P=function(t){var e=t.settings,o=t.onSettingChanged,n=Object(F.f)(),r=Object(F.g)();return Object(d.jsx)("div",{className:"mt-1 mb-4",children:Object(d.jsxs)("header",{className:"row",children:[Object(d.jsx)("div",{className:"col-md-11 title",children:"Kafka Flow"}),Object(d.jsx)("div",{className:"col-md-1 title",children:Object(d.jsx)(K,{onSetttingsClicked:function(){r.pathname.includes("settings")?n.push("/"):n.push("/settings")},onCompactClicked:function(){o("topologyCompact",!e.topologyCompact)},isCompact:e.topologyCompact})}),Object(d.jsx)("div",{className:"col-md-12 subtitle",children:"Visualize the data flowing through a kafka streams topology"})]})})};function D(){return(D=Object(N.a)(C.a.mark((function t(e){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(e));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var J=function(t){return D.apply(this,arguments)};var V=function(t){return t.trim().startsWith("Topologies:")&&!function(t){return/<\/?[a-z][\s\S]*>/i.exec(t)}(t)};var z=function(t){var e=t.settings,o=t.onSettingChanged,n=t.onError,r=function(t){var e=t.target.id,n="checkbox"===t.target.type?t.target.checked:t.target.value;o(e,n)};return Object(d.jsxs)("form",{children:[Object(d.jsx)("h5",{children:"Topology"}),Object(d.jsxs)("div",{className:"form-group mb-2",children:[Object(d.jsx)("label",{htmlFor:"topology",children:"Topology Description"}),Object(d.jsx)("textarea",{rows:"10",className:"form-control",placeholder:"Topology",id:"topology",value:e.topology,onChange:r})]}),Object(d.jsxs)("div",{className:"form-group mb-2",children:[Object(d.jsx)("label",{htmlFor:"topologyUrl",children:"Topology URL"}),Object(d.jsxs)("div",{className:"input-group",children:[Object(d.jsx)("input",{type:"text",className:"form-control",placeholder:"URL to Topology Describe (optional)",id:"topologyUrl",value:e.topologyUrl,onChange:r}),Object(d.jsx)("button",{type:"button",className:"btn btn-outline-primary",id:"topologyLoad",disabled:!e.topologyUrl,onClick:function(){J(e.topologyUrl).then((function(t){return t.text()})).then((function(t){V(t)?o("topology",t):n("Invalid topology loaded")})).catch((function(){return n("Failed to load topology")}))},children:"Load Topology"})]})]}),Object(d.jsxs)("div",{className:"form-check mb-2",children:[Object(d.jsx)("label",{className:"form-check-label",htmlFor:"offsetCheck",children:"Show internal Stores"}),Object(d.jsx)("input",{type:"checkbox",className:"form-check-input",id:"topologyShowStores",checked:e.topologyShowStores,onChange:r})]}),Object(d.jsx)("h5",{className:"mt-5",children:"Offsets"}),Object(d.jsxs)("div",{className:"form-check mb-2",children:[Object(d.jsx)("label",{className:"form-check-label",htmlFor:"offsetCheck",children:"Enable Offset Polling"}),Object(d.jsx)("input",{type:"checkbox",className:"form-check-input",id:"offsetCheck",checked:e.offsetCheck,onChange:r})]}),Object(d.jsxs)("div",{className:"form-group mb-2",children:[Object(d.jsx)("label",{htmlFor:"offsetUrl",children:"Offset URL"}),Object(d.jsx)("input",{type:"text",className:"form-control",placeholder:"URL to load Offsets (optional)",id:"offsetUrl",value:e.offsetUrl,onChange:r,disabled:!e.offsetCheck})]}),Object(d.jsxs)("div",{className:"form-group mb-2",children:[Object(d.jsx)("label",{htmlFor:"offsetInterval",children:"Offset Interval (ms)"}),Object(d.jsx)("input",{type:"text",className:"form-control",placeholder:"URL to load Offsets (optional)",id:"offsetInterval",value:e.offsetInterval,onChange:r,disabled:!e.offsetCheck})]})]})},B=o(85),G=o(145);var W=function(){var t=Object(n.useState)({topology:G.simple,topologyUrl:"",topologyCompact:!1,topologyShowStores:!0,offsetUrl:"",offsetInterval:2e3,offsetCheck:!1}),e=Object(l.a)(t,2),o=e[0],r=e[1],c=function(t,e){r(Object(s.a)(Object(s.a)({},o),{},Object(i.a)({},t,e)))},a=function(t){u.b.error(t)};return Object(d.jsx)(B.a,{basename:"/kafka-flow",children:Object(d.jsxs)("div",{className:"container-fluid",children:[Object(d.jsx)(u.a,{}),Object(d.jsx)(P,{settings:o,onSettingChanged:c}),Object(d.jsxs)(F.c,{children:[Object(d.jsx)(F.a,{path:"/settings",children:Object(d.jsx)(z,{settings:o,onSettingChanged:c,onError:a})}),Object(d.jsx)(F.a,{path:"/",children:Object(d.jsx)(L,{settings:o,onError:a})})]})]})})};o(338);a.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(W,{})}),document.getElementById("root"))}},[[339,1,2]]]);
//# sourceMappingURL=main.f2cd27b7.chunk.js.map